<section class="px-4 py-4 sticky top-0 z-40 backdrop-blur-md bg-white/5">
    <div class="max-w-7xl mx-auto flex flex-col gap-2">

        <p class="pl-4 pb-2 text-sm md:text-base text-gray-300">
            Olá ..., pesquise o carro que combine com você:
        </p>

        <div class="flex items-center gap-4">

            <!-- Botão filtro (mobile) -->
            <button class="md:hidden p-3 rounded-full bg-white/10 border border-white/10" (click)="isFilterOpen = true"
                aria-label="Abrir filtros">

                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707L14 13.414V20l-4-2v-4.586L3.293 6.707A1 1 0 013 6V4z" />
                </svg>

            </button>

            <!-- Input -->
            <div class="flex items-center rounded-full px-4 py-3 flex-1
               bg-white/10 backdrop-blur border border-white/10">

                <svg class="w-5 h-5 text-gray-300 mr-3" fill="none" stroke="currentColor" stroke-width="2"
                    viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8" />
                    <line x1="21" y1="21" x2="16.65" y2="16.65" />
                </svg>

                <input type="text" placeholder="Buscar por marca, modelo ou ano"
                    class="flex-1 bg-transparent outline-none text-white placeholder-gray-400" [(ngModel)]="searchTerm"
                    (input)="applyFilters()" />
            </div>

        </div>

    </div>
</section>

<!-- Overlay -->
<div *ngIf="isFilterOpen" class="fixed inset-0 bg-black/50 z-50 md:hidden" (click)="isFilterOpen = false">
</div>

<!-- Drawer -->
<aside class="fixed bottom-0 left-0 right-0 z-50 md:hidden
         bg-gray-900 backdrop-blur-xl border-t border-white/10
         rounded-t-2xl p-6 transition-transform duration-300" [class.translate-y-full]="!isFilterOpen">

    <div class="flex items-center justify-between mb-4">
        <h3 class="font-semibold text-white">Filtros</h3>
        <button (click)="isFilterOpen = false">✕</button>
    </div>

    <select class="w-full mb-3 p-3 rounded bg-white/10 text-white border border-white/10" [(ngModel)]="selectedBrand"
        (change)="applyFilters()">
        <option value="">Todas as marcas</option>
        <option *ngFor="let brand of brands" [value]="brand" class="text-black italic">
            {{ brand }}
        </option>
    </select>

    <select class="w-full mb-3 p-3 rounded bg-white/10 text-white border border-white/10" [(ngModel)]="selectedYear"
        (change)="applyFilters()">
        <option [ngValue]="''">Todos os anos</option>
        <option *ngFor="let year of years" [ngValue]="year" class="text-black italic">
            {{ year }}
        </option>
    </select>

    <select class="w-full p-2 rounded bg-white/10 text-white border border-white/10" [(ngModel)]="selectedPriceRange"
        (change)="applyFilters()">
        <option value="" class="text-black italic">Todos os preços</option>
        <option value="0-50000" class="text-black italic">Até R$ 50.000</option>
        <option value="50000-100000" class="text-black italic">R$ 50.000 – 100.000</option>
        <option value="100000-200000" class="text-black italic">R$ 100.000 – 200.000</option>
        <option value="200000+" class="text-black italic">Acima de R$ 200.000</option>
    </select>

    <button class="mt-6 w-full py-3 rounded-lg bg-yellow-400 text-gray-900 font-semibold hover:bg-yellow-600" (click)="isFilterOpen = false">
        Aplicar filtros
    </button>
</aside>

<section class="px-4 py-6">
    <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-6">

        <!-- Filtros desktop -->
        <aside class="hidden md:block rounded-xl bg-white/5 backdrop-blur border border-white/10 p-5 h-fit">
            <h3 class="font-semibold mb-4 text-white">Filtros</h3>

            <select class="w-full mb-3 p-2 rounded bg-white/10 text-white border border-white/10"
                [(ngModel)]="selectedBrand" (change)="applyFilters()">
                <option value="">Todas as marcas</option>
                <option *ngFor="let brand of brands" [value]="brand" class="text-black italic">
                    {{ brand }}
                </option>
            </select>

            <select class="w-full mb-3 p-2 rounded bg-white/10 text-white border border-white/10"
                [(ngModel)]="selectedYear" (change)="applyFilters()">
                <option [ngValue]="''">Todos os anos</option>
                <option *ngFor="let year of years" [ngValue]="year" class="text-black italic">
                    {{ year }}
                </option>
            </select>

            <select class="w-full p-2 rounded bg-white/10 text-white border border-white/10"
                [(ngModel)]="selectedPriceRange" (change)="applyFilters()">
                <option value="" class="text-black italic">Todos os preços</option>
                <option value="0-50000" class="text-black italic">Até R$ 50.000</option>
                <option value="50000-100000" class="text-black italic">R$ 50.000 – 100.000</option>
                <option value="100000-200000" class="text-black italic">R$ 100.000 – 200.000</option>
                <option value="200000+" class="text-black italic">Acima de R$ 200.000</option>
            </select>
        </aside>

        <!-- Cards -->
        <div class="md:col-span-3 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

            <div *ngFor="let car of filteredCars"
                class="rounded-2xl overflow-hidden bg-white/5 backdrop-blur border border-white/10 hover:bg-white/10 transition">

                <img [src]="car.image" alt="#" class="w-full h-44 object-cover" />

                <div class="p-4 text-white">
                    <h3 class="font-semibold text-lg">
                        {{ car.brand }} {{ car.model }}
                    </h3>

                    <p class="text-sm text-gray-400 mb-2">
                        {{ car.year }} • {{ car.km }} km
                    </p>

                    <p class="text-sm text-gray-400 break-words whitespace-normal line-clamp-3">
                        {{car.description}}
                    </p>

                    <p class="text-yellow-400 font-bold text-xl mt-2">
                        R$ {{ car.price | number:'1.0-0' }}
                    </p>

                    <button class="mt-4 w-full py-3 rounded-lg bg-yellow-400 text-gray-900 font-semibold">
                        Ver anúncio
                    </button>
                </div>
            </div>

        </div>

    </div>
</section>